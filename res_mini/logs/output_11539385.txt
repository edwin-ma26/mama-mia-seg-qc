[DIAG] Step 1: Checking device...
[DIAG] Using device: cuda
[DIAG] Step 2: Constructing MRIDataset...
[INFO] Initializing MRIDataset for split='train'...
[INFO] Found 100 patients for split 'train'.
[INFO] Loaded 100 valid image-mask pairs.
[INFO] Label distribution: {1: np.int64(74), 0: np.int64(26)}
[DIAG] Dataset length: 100
[DIAG] Step 3: Manually loading a sample from dataset...
[DATA] Preprocessing sample 0: DUKE_258
[PREPROCESS] Loading MRI from: ../images/DUKE_258/DUKE_258_0000.nii.gz
[PREPROCESS] Loading mask from: ../segmentations/automatic/DUKE_258.nii.gz
[PREPROCESS] Running N4 bias correction...
[PREPROCESS] Denoising MRI...
[PREPROCESS] Resampling images to isotropic voxel size...
[PREPROCESS] Resizing images to target shape...
[PREPROCESS] Finished preprocessing.
[DIAG] Sample 0 shape: torch.Size([2, 128, 128, 128]), Label: tensor([0.])
[DIAG] Step 4: Initializing DataLoader (num_workers=0)...
[DIAG] DataLoader ready with 100 batches
[DIAG] Step 5: Getting first batch from DataLoader...
[DATA] Preprocessing sample 0: DUKE_258
[PREPROCESS] Loading MRI from: ../images/DUKE_258/DUKE_258_0000.nii.gz
[PREPROCESS] Loading mask from: ../segmentations/automatic/DUKE_258.nii.gz
[PREPROCESS] Running N4 bias correction...
[PREPROCESS] Denoising MRI...
[PREPROCESS] Resampling images to isotropic voxel size...
[PREPROCESS] Resizing images to target shape...
[PREPROCESS] Finished preprocessing.
[DIAG] Batch 0 - input shape: torch.Size([1, 2, 128, 128, 128]), labels: tensor([[0.]])
[DATA] Preprocessing sample 1: DUKE_142
[PREPROCESS] Loading MRI from: ../images/DUKE_142/DUKE_142_0000.nii.gz
[PREPROCESS] Loading mask from: ../segmentations/automatic/DUKE_142.nii.gz
[PREPROCESS] Running N4 bias correction...
[PREPROCESS] Denoising MRI...
[PREPROCESS] Resampling images to isotropic voxel size...
[PREPROCESS] Resizing images to target shape...
[PREPROCESS] Finished preprocessing.
[DIAG] Batch 1 - input shape: torch.Size([1, 2, 128, 128, 128]), labels: tensor([[0.]])
[DIAG] Step 6: Creating model and running one forward pass...
[INFO] Initializing ResNet model...
[INFO] Model initialized.
[DIAG] Forward pass output shape: torch.Size([1, 1])
[DIAG] âœ… All steps completed successfully. You can safely move to full training.
